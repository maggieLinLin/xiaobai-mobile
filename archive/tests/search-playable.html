<!DOCTYPE html>
<html>
<head>
    <title>æœç´¢æ’­æ”¾æº</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; background: #f9f9f9; }
        audio { width: 100%; margin-top: 10px; }
        code { background: #f0f0f0; padding: 2px 6px; }
        .result { margin-top: 10px; padding: 10px; background: white; border-left: 3px solid #007bff; }
    </style>
</head>
<body>
    <h1>ğŸ” æœç´¢å¯ç”¨çš„æ’­æ”¾æº</h1>
    
    <div class="test">
        <h3>æœç´¢ "ä¸ƒé‡Œé¦™" æ‰€æœ‰çµæœ</h3>
        <div id="results"></div>
    </div>

    <script>
        async function searchAndFindPlayable() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = 'â³ æœç´¢ä¸­...';
            
            try {
                // æœç´¢æ­Œæ›²
                const searchRes = await fetch('https://meting-api-alpha-gilt.vercel.app/api?server=netease&type=search&s=ä¸ƒé‡Œé¦™&limit=50');
                const searchData = await searchRes.json();
                
                resultsDiv.innerHTML = '';
                
                let playableCount = 0;
                
                // éæ­·å‰ 10 é¦–æ­Œæ›²ï¼Œæª¢æŸ¥æ˜¯å¦å¯æ’­æ”¾
                for (let i = 0; i < Math.min(10, searchData.results.length); i++) {
                    const song = searchData.results[i];
                    const songDiv = document.createElement('div');
                    songDiv.className = 'result';
                    songDiv.innerHTML = `
                        <p><strong>${i+1}. ${song.name}</strong> - ${song.artist}</p>
                        <p>ID: <code>${song.id}</code></p>
                        <p>æª¢æŸ¥ä¸­... <span id="check-${i}">â³</span></p>
                        <div id="audio-${i}"></div>
                    `;
                    resultsDiv.appendChild(songDiv);
                    
                    // æª¢æŸ¥æ˜¯å¦èƒ½æ’­æ”¾
                    try {
                        const songRes = await fetch(`https://meting-api-alpha-gilt.vercel.app/api?type=song&id=${song.id}`);
                        const songData = await songRes.json();
                        
                        if (songData.url) {
                            document.getElementById(`check-${i}`).textContent = 'âœ… æœ‰æ’­æ”¾éˆæ¥';
                            document.getElementById(`audio-${i}`).innerHTML = `
                                <audio controls style="width:100%;">
                                    <source src="${songData.url}" type="audio/mpeg">
                                </audio>
                                <p style="font-size:12px;color:#666;">
                                    URL: <code>${songData.url.substring(0, 60)}...</code>
                                </p>
                            `;
                            playableCount++;
                        } else {
                            document.getElementById(`check-${i}`).textContent = 'âŒ ç„¡æ’­æ”¾éˆæ¥';
                        }
                    } catch (e) {
                        document.getElementById(`check-${i}`).textContent = 'âŒ éŒ¯èª¤: ' + e.message;
                    }
                    
                    await new Promise(r => setTimeout(r, 300));
                }
                
                const summary = document.createElement('div');
                summary.style.marginTop = '20px';
                summary.style.padding = '15px';
                summary.style.background = '#e7f3ff';
                summary.style.border = '1px solid #b3d9ff';
                summary.innerHTML = `
                    <p><strong>æª¢æŸ¥å®Œæˆ</strong></p>
                    <p>âœ… å¯æ’­æ”¾: ${playableCount} é¦–</p>
                    <p>âŒ ç„¡æ³•æ’­æ”¾: ${Math.min(10, searchData.results.length) - playableCount} é¦–</p>
                    ${playableCount > 0 ? '<p>âœ… æœç´¢åŠŸèƒ½æ­£å¸¸ï¼Œå¯ä»¥æ’­æ”¾æ‰¾åˆ°çš„æ­Œæ›²</p>' : '<p>âŒ æ‰€æœ‰æ­Œæ›²éƒ½ç„¡æ³•æ’­æ”¾ï¼Œå¯èƒ½æ˜¯ API é™åˆ¶</p>'}
                `;
                resultsDiv.appendChild(summary);
                
            } catch (error) {
                resultsDiv.innerHTML = `âŒ éŒ¯èª¤: ${error.message}`;
            }
        }

        searchAndFindPlayable();
    </script>
</body>
</html>
