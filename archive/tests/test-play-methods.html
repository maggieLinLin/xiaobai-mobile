<!DOCTYPE html>
<html>
<head>
    <title>æ¸¬è©¦ä¸åŒæ’­æ”¾æ–¹å¼</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        audio { width: 100%; margin-top: 10px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ğŸµ æ¸¬è©¦ä¸åŒæ’­æ”¾æ–¹å¼</h1>
    
    <div class="test">
        <h3>æ–¹å¼1: ç›´æ¥åŸå§‹ URL</h3>
        <p>ID: 2647102754 (ä¸ƒé‡Œé¦™ å¥³è²ç‰ˆ)</p>
        <p>URL: <code>https://music.163.com/song/media/outer/url?id=2647102754.mp3</code></p>
        <audio id="audio1" controls></audio>
        <button onclick="play1()">æ’­æ”¾</button>
        <p id="status1"></p>
    </div>

    <div class="test">
        <h3>æ–¹å¼2: ä½¿ç”¨ä»£ç† (Corsive)</h3>
        <audio id="audio2" controls></audio>
        <button onclick="play2()">æ’­æ”¾</button>
        <p id="status2"></p>
    </div>

    <div class="test">
        <h3>æ–¹å¼3: ä½¿ç”¨ä»£ç† (allorigins)</h3>
        <audio id="audio3" controls></audio>
        <button onclick="play3()">æ’­æ”¾</button>
        <p id="status3"></p>
    </div>

    <div class="test">
        <h3>æ–¹å¼4: æŸ¥çœ‹æ§åˆ¶å°è¼¸å‡º</h3>
        <p>æŒ‰ F12 æ‰“é–‹é–‹ç™¼è€…å·¥å…·ï¼ŒæŸ¥çœ‹ Console æ¨™ç±¤çš„è©³ç´°éŒ¯èª¤ä¿¡æ¯</p>
        <button onclick="testFetch()">æ¸¬è©¦ Fetch</button>
        <p id="status4"></p>
    </div>

    <script>
        const songId = '2647102754';
        const originalUrl = `https://music.163.com/song/media/outer/url?id=${songId}.mp3`;

        function play1() {
            const audio = document.getElementById('audio1');
            audio.src = originalUrl;
            audio.play().then(() => {
                document.getElementById('status1').textContent = 'âœ… æ’­æ”¾ä¸­...';
            }).catch(e => {
                document.getElementById('status1').textContent = 'âŒ ' + e.message;
                console.error('æ–¹å¼1 éŒ¯èª¤:', e);
            });
        }

        function play2() {
            const audio = document.getElementById('audio2');
            // ä½¿ç”¨ corsive ä»£ç†
            const proxyUrl = `https://corsive.herokuapp.com/${encodeURIComponent(originalUrl)}`;
            console.log('æ–¹å¼2 URL:', proxyUrl);
            
            audio.src = proxyUrl;
            audio.play().then(() => {
                document.getElementById('status2').textContent = 'âœ… æ’­æ”¾ä¸­...';
            }).catch(e => {
                document.getElementById('status2').textContent = 'âŒ ' + e.message;
                console.error('æ–¹å¼2 éŒ¯èª¤:', e);
            });
        }

        function play3() {
            const audio = document.getElementById('audio3');
            // ä½¿ç”¨ allorigins ä»£ç†
            const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(originalUrl)}`;
            console.log('æ–¹å¼3 URL:', proxyUrl);
            
            audio.src = proxyUrl;
            audio.play().then(() => {
                document.getElementById('status3').textContent = 'âœ… æ’­æ”¾ä¸­...';
            }).catch(e => {
                document.getElementById('status3').textContent = 'âŒ ' + e.message;
                console.error('æ–¹å¼3 éŒ¯èª¤:', e);
            });
        }

        async function testFetch() {
            const statusDiv = document.getElementById('status4');
            statusDiv.textContent = 'â³ æ¸¬è©¦ä¸­...';
            
            try {
                console.log('é–‹å§‹ fetch:', originalUrl);
                const res = await fetch(originalUrl);
                console.log('HTTP ç‹€æ…‹:', res.status);
                console.log('Content-Type:', res.headers.get('content-type'));
                
                const blob = await res.blob();
                console.log('Blob å¤§å°:', blob.size, 'bytes');
                console.log('Blob é¡å‹:', blob.type);
                
                const blobUrl = URL.createObjectURL(blob);
                document.getElementById('audio1').src = blobUrl;
                
                statusDiv.textContent = 'âœ… Blob å‰µå»ºæˆåŠŸï¼Œå·²è¨­ç½®åˆ°æ–¹å¼1';
            } catch (e) {
                console.error('Fetch æ¸¬è©¦éŒ¯èª¤:', e);
                statusDiv.textContent = 'âŒ éŒ¯èª¤: ' + e.message;
            }
        }
    </script>
</body>
</html>
