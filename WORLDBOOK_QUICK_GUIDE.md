# 🌍 世界书多选功能 - 快速使用指南

## 🚀 5 分钟上手

### 步骤 1: 打开 AI 角色资料

1. 进入 LINEE 应用
2. 点击任意 AI 角色好友
3. 向下滚动,找到 **"关联世界书"** 卡片

> 💡 提示: 只有 AI 角色才会显示世界书选项

---

### 步骤 2: 选择全局世界书

1. 点击 **"选择全局世界书"** 按钮
2. 看到弹窗显示可用的世界书列表:

```
请选择要关联的全局世界书（可多选）：

1. 小白机世界 
2. 现代都市 
3. 奇幻大陆 ✅

输入序号（多个用逗号分隔，例如：1,3）
输入 0 清空所有选择
```

3. 输入你想选择的序号:
   - **单选**: 输入 `1` (选择第 1 个)
   - **多选**: 输入 `1,3` (选择第 1 和第 3 个)
   - **清空**: 输入 `0` (清空所有选择)

4. 点击确定,完成!

---

### 步骤 3: 选择局部世界书

1. 点击 **"选择局部世界书"** 按钮
2. 同样的操作,选择你需要的局部世界书
3. 局部世界书通常包含角色专属的背景设定

---

### 步骤 4: 验证设置

打开调试面板验证:

1. 点击右上角 **🐛 Debug** 按钮
2. 查看 "当前角色信息" 部分
3. 确认看到关联的世界书

```
关联世界书:
  全局: global_main, global_modern
  局部: local_school_001
```

4. 发送一条消息,在 "最后发送的 System Prompt" 中
5. 搜索 **"【世界观信息】"**,确认世界书内容已加载

---

## 💡 使用技巧

### 技巧 1: 合理搭配全局和局部

**推荐组合:**

```
全局世界书: 通用背景设定
├─ 小白机世界 (基础设定)
└─ 现代都市 (时代背景)

局部世界书: 角色专属设定
├─ 学校环境 (角色活动场所)
└─ 角色关系网 (人际关系)
```

**效果:**
- 通用背景 + 角色专属 = 完整世界观
- 避免重复,提高效率

---

### 技巧 2: 利用覆盖机制

**场景:** 同一个关键词在不同世界书中有不同定义

```
全局世界书:
  "学校": "普通高中"

局部世界书:
  "学校": "魔法学院"

最终生效: "魔法学院" (局部覆盖全局)
```

**应用:**
- 全局定义通用概念
- 局部定义特殊情况
- 自动处理冲突

---

### 技巧 3: 按需选择

**不要贪多!**

❌ **错误做法:**
```
选择 10 个全局世界书 + 8 个局部世界书
→ Prompt 过长,影响性能
```

✅ **正确做法:**
```
选择 1-2 个全局世界书 + 2-3 个局部世界书
→ 精简高效,效果更好
```

---

## 📋 常见场景

### 场景 1: 现代都市恋爱剧

**角色:** 22岁艺术系学生林雨

**全局世界书:**
- 现代都市 (时代背景)
- 小白机世界 (基础设定)

**局部世界书:**
- 艺术学院 (学校环境)
- 江南水乡 (地理位置)

**效果:** 角色在对话中会自然提到学校、江南、现代生活等元素

---

### 场景 2: 奇幻冒险

**角色:** 300岁精灵法师

**全局世界书:**
- 奇幻大陆 (世界设定)
- 魔法体系 (力量系统)

**局部世界书:**
- 精灵王国 (种族背景)
- 角色历史 (个人经历)

**效果:** 角色会展现出种族特点和魔法世界的细节

---

### 场景 3: 校园日常

**角色:** 高中生

**全局世界书:**
- 现代都市
- 日本文化 (如果是日系设定)

**局部世界书:**
- XX 高中 (学校设定)
- 班级成员 (同学关系)

**效果:** 对话中会自然融入学校生活的细节

---

## 🎯 效果对比

### 没有世界书

```
用户: 我们去学校吧
AI: 好的，我们去学校。
```

❌ 缺乏细节,很干燥

---

### 使用世界书

**世界书设定:**
```
【学校】：位于江南水乡的艺术学院，白墙黑瓦，小桥流水
【画室】：学院最受欢迎的地方，阳光从天窗洒下
```

**对话效果:**
```
用户: 我们去学校吧
AI: 好啊！|||走过那座小石桥|||阳光正好照进画室|||超适合画画的~
```

✅ 丰富细节,自然生动

---

## ⚙️ 高级用法

### 动态切换世界书

**场景:** 角色在不同场景下有不同背景

**做法:**
1. 创建多个局部世界书
   - `local_school` (学校场景)
   - `local_home` (家庭场景)
   - `local_cafe` (咖啡厅场景)

2. 根据剧情切换
   - 在学校: 只选 `local_school`
   - 在家: 只选 `local_home`
   - 在咖啡厅: 只选 `local_cafe`

3. 全局世界书保持不变
   - `global_modern` (始终启用)

---

### 世界书分层

**推荐结构:**

```
第 1 层: 基础设定 (全局)
├─ 小白机世界
└─ 时代背景 (现代/古代/未来)

第 2 层: 区域设定 (全局)
├─ 地理环境
└─ 社会制度

第 3 层: 角色专属 (局部)
├─ 活动场所
└─ 人际关系
```

**优点:**
- 清晰的层次结构
- 易于管理和复用
- 避免重复内容

---

## 🐛 常见问题

### Q1: 选择了世界书,但 AI 没反应?

**检查步骤:**
1. 打开调试面板 (🐛 Debug)
2. 查看 "最后发送的 System Prompt"
3. 搜索 "【世界观信息】"

**如果找不到:**
→ 说明世界书没有匹配到关键词
→ 尝试在对话中提到世界书的关键词

**例如:**
```
世界书关键词: "学校", "画室"
用户消息: "今天天气真好" ← 没有匹配
用户消息: "我们去学校画室" ← 会匹配
```

---

### Q2: 选择太多世界书会怎样?

**影响:**
- ⚠️ Prompt 过长,超出模型限制
- ⚠️ 响应变慢
- ⚠️ 可能遗漏部分内容

**建议:**
- 全局世界书: ≤ 3 个
- 局部世界书: ≤ 5 个
- 总条目数: ≤ 50 个

---

### Q3: 如何知道哪个世界书生效了?

**方法 1: 调试面板**
```
🐛 Debug → 最后的 System Prompt
查看 "【世界观信息】" 部分
```

**方法 2: 测试对话**
```
提到某个关键词 → 看 AI 是否回应相关内容
```

---

### Q4: 世界书可以删除吗?

**可以!**

在世界书 App 中删除世界书后:
- 已关联的角色会显示 "[已删除]" 标签
- 不会影响角色的其他功能
- 建议重新选择可用的世界书

---

## 📚 相关文档

- **详细更新报告:** `WORLDBOOK_MULTI_SELECT_UPDATE.md`
- **调试面板使用:** `DEBUG_PANEL_USAGE.md`
- **AI 行为修复:** `AI_BEHAVIOR_FIX_REPORT.md`

---

## 🎉 快速上手总结

```
1️⃣ 打开 AI 角色资料
    ↓
2️⃣ 找到 "关联世界书" 卡片
    ↓
3️⃣ 选择全局世界书 (1-2个)
    ↓
4️⃣ 选择局部世界书 (2-3个)
    ↓
5️⃣ 开始聊天,享受丰富的世界观!
```

---

**最后更新:** 2024年12月7日  
**预计阅读时间:** 5 分钟  
**难度等级:** ⭐⭐ (简单)  

🎊 **现在就去试试吧!给你的 AI 角色一个完整的世界!**
